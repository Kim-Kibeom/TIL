# 가상화

Docker 내용을 찾다보니 전가상화보단 반가상화, 반가상화보단 Docker가 더 낫다는 내용을 보았다. 이름에서 유추할 수는 있엇지만 정확한 내용을 찾아보고 싶어졌다. 

먼저 가상화가 필요한 이유를 생각해보자. 이제는 온프레미스의 형태로 직접 서버를 관리하는 것보다 아마존이나 구글의 리소스를 빌려 사용하는 클라우드 컴퓨팅의 사례가 많아졌다. 클라우드 컴퓨팅이라고 해도 결국 물리적인 서버가 존재할 것이다. 만약 프로그램 하나에 서버 하나를 할당한다면 필요한 서버의 수가 기하급수적으로 늘어날 것이다. 이는 당연히 관리도 쉽지 않고 비효율적이다.

여기서 가상화가 등장한다. 쉽게 생각해 VM ware, Virtual Box와 같은 프로그램을 통해 운영체제 위에 다른 운영체제가 동작할 수 있게 한다고 생각하면 된다. 즉 하나의 컴퓨터에서 여러 운영체제를 사용할 수 있다는 것이다. 이 부분에서 생각할 점은 더 이상 여러 프로그램을 돌리기 위해 많은 서버를 사용할 필요 없이 하나의 좋은 컴퓨터(서버)를 통해 돌리면 된다는 것이다. 

검색해보니 가상화의 종류도 많던데 일단 궁금했던 전가상화와 반가상화에 대해 알아보려고 한다.

## 전가상화

기본적인 구조는 하드웨어 위에 Hypervisor(하이퍼 바이저)가, 그 위에 guestOS가 존재한다. 따라서 guestOS는 하이퍼 바이저를 통해 하드웨어와 신호를 주고 받는다. 하지만 guestOS마다 같은 연산이라도 내부 동작이 다를 수 있기 때문에 그냥 하드웨어가 알아듣고 동작을 처리할 수 없다. 여기서 하이퍼 바이저가 중간에서 번역하는 역할을 해준다. 또한 guestOS들에게 자원을 할당하고 조율하는 역할도 해준다. 정리하자면 다음과 같다.

1. OS들의 커널을 번역해서 하드웨어에게 알려준다.
2. OS들에게 자원을 할당하고 조율한다.

## 반가상화

반가상화는 전가상화와 다르게 하이퍼바이저가 번역을 해주는 것이 아닌 사용자가 직접 OS 커널을 수정하여 번역한다. 여기서 하이퍼바이저는 커널에 번역기능이 있으니 번역은 제외하고 자원 관리 역할만 해준다. 우리가 OS의 커널을 수정하려면 직접 소스를 다 까보는 것은 물론이고 오픈소스가 아니라면 이마저도 쉽지 않다. 물론 소스 까보는 것도 쉽지 않다. 그러나 요새는 Xen에서 제공하는 툴로 윈도우와 같이 오픈소스가 아닌 OS도 수정이 가능하다고 한다. 

더 깊게 들어가면 하이퍼바이저도 type1, 2 로 나뉘고 더 복잡한 것 같은데 당장은 이에 대한 기초적인 개념이 우선이라고 생각해 이 정도만 정리하도록 한다.

출처 : 

[https://blog.naver.com/alice_k106/220217868679](https://blog.naver.com/alice_k106/220217868679)

[https://blog.naver.com/alice_k106/220218878967](https://blog.naver.com/alice_k106/220218878967)
